(this["webpackJsonpcovid-viz"]=this["webpackJsonpcovid-viz"]||[]).push([[0],{204:function(e,t,a){e.exports=a(219)},218:function(e,t,a){},219:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(17),o=a.n(i),c=a(14),s=a.n(c),l=a(21),u=a(54),d=a(16),m=a(2),f=a(48),v=a(9),h=a(131),p=a(273),g=a(42),b=a(82),_=a.n(b),E=function(){var e=Object(l.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:return e.next=4,e.sent.json();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=a(116),x=a.n(y),O=function(e){var t,a,n,r,i;return null!==(t=null!==(a=null===(n=null===e||void 0===e?void 0:e.properties)||void 0===n?void 0:n.ADMIN)&&void 0!==a?a:null===(r=null===e||void 0===e?void 0:e.properties)||void 0===r?void 0:r.admin)&&void 0!==t?t:null===(i=null===e||void 0===e?void 0:e.properties)||void 0===i?void 0:i.NAME_0},w=function(e){var t,a,n;return null!==(t=null===(a=null===e||void 0===e?void 0:e.properties)||void 0===a?void 0:a.name)&&void 0!==t?t:null===(n=null===e||void 0===e?void 0:e.properties)||void 0===n?void 0:n.NAME_1},j=function(e){e.features=e.features.filter((function(e){var t=O(e);return"China"!==t&&"United States of America"!==t}))};function S(){return C.apply(this,arguments)}function C(){return(C=Object(l.a)(s.a.mark((function e(){var t,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[{fetch:fetch("./ne_110m_admin_0_countries.geojson"),preprocess:j},fetch("./ne_110m_admin_1_states_provinces.geojson"),fetch("./gadm36_CHN_1.json")],a=void 0,e.next=4,Promise.allSettled(t.map(function(){var e=Object(l.a)(s.a.mark((function e(t){var n,r,i,o,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(null!==(n=t.fetch)&&void 0!==n?n:t);case 2:c=e.sent,x()(c,!0),null===(r=(i=t).preprocess)||void 0===r||r.call(i,c),void 0===a?a=c:(o=a.features).push.apply(o,Object(g.a)(c.features));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:return e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var I=function(){var e=Object(l.a)(s.a.mark((function e(){var t,a,n,r,i,o,c,l,u,d,m,f,h,p,g,b,E=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=E.length>0&&void 0!==E[0]?E[0]:"https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_global.csv",a=E.length>1?E[1]:void 0,n=v.q("%-m/%-d/%y"),r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=a.features.find((function(a){var n=O(a),r=w(a);return n===e&&r===t}));return n},i=function(e){return e.findIndex((function(e){return null!==n(e)}))},e.next=7,v.e(t,(function(e){var t,a,n=null!==(t=e["Country/Region"])&&void 0!==t?t:e.Country_Region,o=null!==(a=e["Province/State"])&&void 0!==a?a:e.Province_State,c=Object.keys(e),s=[];if(""===o&&(o=void 0),"US"!==n||void 0!==o){"US"===n&&(n="United States of America"),void 0!==o&&!r(n,o)&&r(n)&&(o=void 0);for(var l=i(c);l<c.length;++l){var u=e[c[l]];_()(void 0!==u),s.push(+u)}return{country:n,state:o,values:s}}}));case 7:for(o=e.sent,c=0;c<o.length;++c)for(l=o[c],u=function(e){var t=o[e];l.country===t.country&&l.state===t.state&&(l.values=l.values.map((function(a,n){return d=e,a+t.values[n]})),o.splice(e,1),--e),d=e},d=c+1;d<o.length;++d)u(d);for(m=o.columns,f=[],h=i(m),p=h;p<m.length;++p)g=m[p],b=n(g),_()(b),f.push(b);return e.abrupt("return",{dates:f,data:o});case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(l.a)(s.a.mark((function e(t,a,n){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Map,e.next=3,Promise.allSettled(t.map(function(){var e=Object(l.a)(s.a.mark((function e(t){var n,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.func,i=t.path,e.next=3,I(i,a);case 3:o=e.sent,r.has(n)||r.set(n,[]),r.get(n).push(o);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:Object(g.a)(r.keys()).forEach((function(e){var t,a=r.get(e),i={data:[],dates:[]},o=Object(u.a)(a);try{for(o.s();!(t=o.n()).done;){var c,s=t.value;0===i.dates.length&&(i.dates=s.dates),(c=i.data).push.apply(c,Object(g.a)(s.data))}}catch(l){o.e(l)}finally{o.f()}void 0===n.startDate&&(n.startDate=i.dates[0]),e(i)}));case 4:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),D=a(117),M=a(132);function z(e){var t=e.renderer,a=e.globe,n=e.camera,r=e.onClick,i=t.domElement,o=new m.Q,c=new m.eb,s={clientX:0,clientY:0},l=function(){var e,t;return{clientX:null!==(e=v.h.clientX)&&void 0!==e?e:v.h.changedTouches[0].clientX,clientY:null!==(t=v.h.clientY)&&void 0!==t?t:v.h.changedTouches[0].clientY}},u=function(){var e=l();if(!(Math.sqrt(Math.pow(s.clientX-e.clientX,2)+Math.pow(s.clientY-e.clientY,2))>5)){var t=i.getBoundingClientRect(),u=t.width,d=t.height;c.x=e.clientX/u*2-1,c.y=-e.clientY/d*2+1,o.setFromCamera(c,n);var m=o.intersectObjects([a],!0);if(m.length>0){var f=function(e){var t=e.x,a=e.y,n=e.z,r=Math.sqrt(t*t+a*a+n*n),i=Math.acos(a/r),o=Math.atan2(n,t);return{lat:90-180*i/Math.PI,lng:90-180*o/Math.PI-(o<-Math.PI/2?360:0),altitude:r/100-1}}(m[0].point);r(f)}else r()}},d=v.p(i),f=function(){s=l()};d.on("mousedown",f),d.on("click",u),d.on("touchstart",f),d.on("touchend",u)}function N(e){var t=e;return t.forEach((function(e){var t=0;e.densities.forEach((function(t,a){e.densities[a].density=Math.pow(e.densities[a].density,1)})),e.densities.forEach((function(e){t+=e.density})),e.densities.forEach((function(a,n){e.densities[n].density/=t})),t=0,e.densities.forEach((function(a,n){e.densities[n].density+=t,t=e.densities[n].density}))})),t}var T=function(){var e=Object(l.a)(s.a.mark((function e(){var t,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[fetch("./country-density.json"),fetch("./china-density.json"),fetch("./usa-density.json")],a=[],e.next=4,Promise.allSettled(t.map(function(){var e=Object(l.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=N,e.next=3,E(t);case 3:e.t1=e.sent,n=(0,e.t0)(e.t1),a.push.apply(a,Object(g.a)(n));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:return e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),R=a(119),A=a(120),P=a.n(A),V=a(121),B=function(){var e=10;return V.isMobile&&(e=30),e},F=function(e,t,a,n,r,i){var o=[];t.features.map((function(t){var a,o,c,s,l=O(t),u=w(t),d=function(e){return e.country===l&&e.state===u};return{geoBounds:v.j(t.geometry),feature:t,densities:null===(a=e.find((function(e){return e.admin===l&&e.admin_1===u})))||void 0===a?void 0:a.densities,statsConfirmed:null===(o=n.data.find(d))||void 0===o?void 0:o.values,statsRecovered:null===(c=r.data.find(d))||void 0===c?void 0:c.values,statsDeaths:null===(s=i.data.find(d))||void 0===s?void 0:s.values}})).forEach((function(e){var t,a;if(e.statsConfirmed){var n=function(e){var t=Math.random(),a=P()(e.densities,{density:t},(function(e,t){return e.density-t.density}));a<0&&(a=-a-1),a=Math.max(0,Math.min(e.densities.length-1,a));var n=Object(R.a)({},e.densities[a].point);return n.lat+=r(),n.lng+=r(),n},r=function(){return(2*Math.random()-1)*(360/4096/2)},i=B(),c=o.length,s=function(e,t){var a,n,r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=null!==(a=e[t])&&void 0!==a?a:0,s=null!==(n=e[t-1])&&void 0!==n?n:0,l=(c-s)/i,u=null!==(r=o.remainder)&&void 0!==r?r:0;if((u+=l-Math.floor(l))>=1){var d=Math.floor(u);l+=d,u-=d}return o.remainder=u,Math.floor(l)},l={},u={},d={};if(e.statsConfirmed){e.statsConfirmed.forEach((function(t,a){for(var r=s(e.statsConfirmed,a,l),i=0;i<r;++i)o.push({point:n(e),time:a,recoveredTime:a+14})}));var m=e.statsConfirmed.map((function(){return{recovered:0,dead:0}}));null===(t=e.statsRecovered)||void 0===t||t.forEach((function(t,a){var n=s(e.statsRecovered,a,u);m[a].recovered+=n})),null===(a=e.statsDeaths)||void 0===a||a.forEach((function(t,a){var n=s(e.statsDeaths,a,d);m[a].dead+=n}));var f=c;m.forEach((function(e,t){for(var a=0;a<e.dead;++a){var n=o[f++];if(void 0===n)return;n.recoveredTime=void 0,n.deadTime=t}for(var r=0;r<e.recovered;++r){var i=o[f++];if(void 0===i)return;i.recoveredTime=t}}))}}})),o.forEach((function(e,t){var a=Math.random();o[t].time+=a,void 0!==o[t].recoveredTime&&(o[t].recoveredTime+=a),void 0!==o[t].deadTime&&(o[t].deadTime+=a)}));var c=new m.g,s=new Float32Array(o.map((function(e){var t=function(e){var t=e.lat,a=e.lng,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=(90-t)*Math.PI/180,i=(90-a)*Math.PI/180,o=100*(1+n);return{x:o*Math.sin(r)*Math.cos(i),y:o*Math.cos(r),z:o*Math.sin(r)*Math.sin(i)}}(e.point);return[t.x,t.y,t.z]})).flat()),l=new Float32Array(o.map((function(e){return e.time}))),u=new Float32Array(o.map((function(e){var t;return null!==(t=e.recoveredTime)&&void 0!==t?t:Number.POSITIVE_INFINITY}))),d=new Float32Array(o.map((function(e){var t;return null!==(t=e.deadTime)&&void 0!==t?t:Number.POSITIVE_INFINITY})));c.setAttribute("position",new m.f(s,3)),c.setAttribute("confirmed_time",new m.f(l,1)),c.setAttribute("recovered_time",new m.f(u,1)),c.setAttribute("dead_time",new m.f(d,1));var f=new m.T({uniforms:{time:{value:0}},vertexShader:"uniform float time;\nuniform bool use_recovery_data;\nattribute float confirmed_time;\nvarying float var_confirmed_time;\nattribute float recovered_time;\nvarying float var_recovered_time;\nattribute float dead_time;\nvarying float var_dead_time;\nvarying float circle_blend_factor;\n\nconst float minsize = 1.;\nconst float maxsize = 7.;\nconst float dead_maxsize = 14.;\nconst float big_value = 1e30;\n\nvoid main() {\n  var_confirmed_time = confirmed_time;\n  var_recovered_time = use_recovery_data ? recovered_time : big_value;\n  var_dead_time = dead_time;\n\n  vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n  float x = time - confirmed_time;\n  float y = time - dead_time;\n\n  if (x < 0.)\n    x = 0.;\n  else\n    x = mix(minsize, maxsize, exp(-x));\n\n  if (y >= 0.)\n    x = mix(minsize, dead_maxsize, exp(-y));\n\n  circle_blend_factor = min(max(0., x - 1.), 1.);\n\n  gl_PointSize = x;\n  gl_Position = projectionMatrix * mvPosition;\n}\n",fragmentShader:"uniform float time;\nuniform float extinction_time;\nuniform bool keep_deaths;\nvarying float var_confirmed_time;\nvarying float var_recovered_time;\nvarying float var_dead_time;\nvarying float circle_blend_factor;\n\nconst vec3 confirmed_color = vec3(0., 0., 1.);\nconst vec3 recovered_color = vec3(0., .25, 0.);\nconst vec3 dead_color = vec3(1., 0., 0.);\n\nconst float big_value = 1e30;\n\nvoid main() {\n  float x = time - var_confirmed_time;\n  float y = x;\n\n  if (x < 0.)\n    x = 0.;\n  else\n    x = 1.;\n  if (y < 0.)\n    y = 0.;\n  else\n    y = exp(-y * 10.);\n\n  float blend = max(0., 1. - length(gl_PointCoord.st * 2. - 1.));\n  float blur = .01;\n\n  blend = smoothstep(.5 - blur, .5 + blur, blend);\n  blend = mix(1., blend, circle_blend_factor);\n\n  float extinct_time = var_confirmed_time + extinction_time;\n\n  if (keep_deaths && var_dead_time < big_value) {\n    extinct_time = big_value;\n  }\n\n  float z = time - extinct_time;\n\n  if (z >= 0.)\n    blend = mix(0., blend, exp(-z));\n\n  vec3 color = confirmed_color * x;\n\n  color = mix(color, recovered_color,\n              max(0., min(1., time - var_recovered_time - 1.)));\n\n  if (time - var_dead_time >= 0.)\n    color = dead_color;\n\n  color += vec3(1e-2);\n\n  gl_FragColor = vec4(color, blend * x);\n}",blending:m.l,blendEquation:m.a,blendSrc:m.X,blendSrcAlpha:m.L,blendDst:m.L,transparent:!0,depthWrite:!1}),h=new m.N(c,f);return a.dispatcher.on("timeChanged.data-points",(function(e){f.uniforms.time.value=e})),h.onBeforeRender=function(){f.uniforms.extinction_time={value:a.extinction},f.uniforms.keep_deaths={value:a.keepDeaths},f.uniforms.use_recovery_data={value:a.useRecoveryData}},h},G=[112,96];function U(e){return e.map((function(t,a){var n,r=t/(null!==(n=e[a-1])&&void 0!==n?n:0);if(Number.isFinite(r))return r}))}var Y=a(263),H=a(268),J=a(264),L=a(269),X=a(136),q=a(130),W=a.n(q),K=a(127),Q=a.n(K),$=a(128),Z=a.n($),ee=a(259),te=a(129),ae=a.n(te),ne=a(220),re=a(262),ie=a(265),oe=a(266),ce=a(276),se=a(267),le=a(278),ue=a(270),de=a(271),me=a(272),fe=a(274),ve=a(122),he=a.n(ve);function pe(e){return function(t,a){return e(a)}}function ge(e){var t=e.paused,a=e.setPaused,i=e.globals,o=he()(),c=function(e){return[i[e],function(t){i[e]=t,o()}]},u=Object(n.useState)(!1),m=Object(d.a)(u,2),f=m[0],v=m[1],h=Object(n.useState)(!1),p=Object(d.a)(h,2),g=p[0],b=p[1],_=Object(n.useState)(!1),y=Object(d.a)(_,2),x=y[0],O=y[1],w=Object(n.useState)(!1),j=Object(d.a)(w,2),S=j[0],C=j[1],I=Object(n.useState)(),k=Object(d.a)(I,2),D=k[0],M=k[1],z=Object(n.useState)(),N=Object(d.a)(z,2),T=N[0],R=N[1],A=Object(n.useState)(!0),P=Object(d.a)(A,2),V=P[0],F=P[1],G=Object(n.useState)(i.extinction),U=Object(d.a)(G,2),q=U[0],K=U[1],$=c("keepDeaths"),te=Object(d.a)($,2),ve=te[0],ge=te[1],be=c("useRecoveryData"),_e=Object(d.a)(be,2),Ee=_e[0],ye=_e[1],xe=f||g;return Object(n.useEffect)((function(){void 0===D&&S&&Object(l.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(fetch("./licenseInfos.json"));case 2:t=e.sent,M(t);case 4:case"end":return e.stop()}}),e)})))()}),[S,D]),Object(n.useEffect)((function(){i.extinction=V?q:Number.POSITIVE_INFINITY}),[q,V]),r.a.createElement("div",{className:"ui-overlay"},r.a.createElement(ne.a,{in:!xe},r.a.createElement("div",{className:"buttons"},r.a.createElement(ee.a,{"aria-label":"pause toggle",onClick:function(){return a(!t)},className:"pause-toggle"},t?r.a.createElement(Q.a,null):r.a.createElement(Z.a,null)),r.a.createElement(ee.a,{"aria-label":"change visualization parameters",onClick:function(){return b(!0)},className:"parameters"},r.a.createElement(ae.a,null)),r.a.createElement(ee.a,{"aria-label":"help",onClick:function(){return v(!0)},className:"help"},r.a.createElement(W.a,null)))),r.a.createElement(re.a,{in:g,unmountOnExit:!0},r.a.createElement("div",{className:"info-card"},r.a.createElement(Y.a,null,r.a.createElement(J.a,{className:"description"},r.a.createElement(X.a,{variant:"h5",component:"h2"},"Visualization parameters"),r.a.createElement(ie.a,{row:!0},r.a.createElement(oe.a,{control:r.a.createElement(ce.a,{checked:V,onChange:pe(F)}),label:"Extinction"})),r.a.createElement(se.a,{container:!0,spacing:2},r.a.createElement(se.a,{item:!0,xs:!0},r.a.createElement(le.a,{value:q,onChange:pe(K),"aria-labelledby":"extinction",valueLabelDisplay:"auto",disabled:!V,min:1})),r.a.createElement(se.a,{item:!0},r.a.createElement(X.a,null,q," day",q>1?"s":null))),r.a.createElement(ie.a,{row:!0},r.a.createElement(oe.a,{control:r.a.createElement(ce.a,{checked:ve,onChange:pe(ge)}),label:"Keep deaths"}),r.a.createElement(oe.a,{control:r.a.createElement(ce.a,{checked:Ee,onChange:pe(ye)}),label:"Use recovery data"}))),r.a.createElement(H.a,null,r.a.createElement(L.a,{size:"small",onClick:function(){return b(!1)}},"Dismiss"))))),r.a.createElement(re.a,{in:f,unmountOnExit:!0},r.a.createElement("div",{className:"info-card"},r.a.createElement(Y.a,null,r.a.createElement(J.a,{className:"description"},r.a.createElement(X.a,{variant:"h5",component:"h2"},"COVID-19 Visualizer"),r.a.createElement(X.a,{paragraph:!0},"This webapp fetches the latest ",r.a.createElement(ue.a,{href:"https://github.com/CSSEGISandData/COVID-19"},"JHU CSSE COVID-19 Data")," and generates a point-based visualization in ",r.a.createElement(ue.a,{href:"https://threejs.org/"},"three.js")," on top of a"," ",r.a.createElement(ue.a,{href:"https://github.com/vasturiano/three-globe"},"ThreeJS Globe Visualization"),". This visualization largely follows the same approach as in ",r.a.createElement(ue.a,{href:"https://github.com/EFHIII/COVID-19"},"Edward Haas's COVID-19 Confirmed cases map over time"),", but with interactive parameters (e.g. point extinction) and processed in real-time using the latest data."),r.a.createElement(X.a,{paragraph:!0},"Each point in the visualizer represents ",B()," cases."),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(X.a,null,r.a.createElement("span",{style:{color:"steelblue"}},"Blue")," represents confirmed cases")),r.a.createElement("li",null,r.a.createElement(X.a,null,r.a.createElement("span",{style:{color:"red"}},"Red")," represents deaths")),r.a.createElement("li",null,r.a.createElement(X.a,null,r.a.createElement("span",{style:{color:"green"}},"Green")," represents recovered cases",r.a.createElement("br",null),"In many cases, the recovered case data is unreliable or missing. This visualizer assumes a recovery time of 14 days if no other data is available."))),r.a.createElement(X.a,{paragraph:!0},"The points are positioned randomly within each region according to population density."),r.a.createElement(X.a,{paragraph:!0},"The blue and red lines on the chart indicate confirmed cases and deaths, respectively. The faint blue and red lines represent the multiplicative increase in confirmed cases and deaths, respectively, from the following day. The plot's range is 1.0x-1.25x (bottom-top) daily growth factor."),r.a.createElement(X.a,{paragraph:!0},"You can click on the globe to limit the chart to a specific region. Clicking outside any region, reverts the chart to global mode."),r.a.createElement(X.a,{paragraph:!0},"The chart is draggable and zoomable in the time-axis. Clicking on a point in the chart will revert the visualization to the clicked time. The current time indicator can be dragged for scrubbing purposes.")),r.a.createElement(H.a,null,r.a.createElement(L.a,{size:"small",onClick:function(){return v(!1)}},"Dismiss"),r.a.createElement(L.a,{size:"small",onClick:function(){return O(!x)}},"Sources"),r.a.createElement(L.a,{size:"small",onClick:function(){return C(!S)}},"Dependencies"),r.a.createElement(L.a,{size:"small",href:"https://github.com/trylle/covid-viz"},"GitHub")),r.a.createElement(de.a,{in:x,timeout:"auto",unmountOnExit:!0},r.a.createElement(J.a,{className:"sources"},r.a.createElement(X.a,{paragraph:!0},"The COVID-19 statistics for this visualizer are sourced from"," ",r.a.createElement(ue.a,{href:"https://github.com/CSSEGISandData/COVID-19"},"JHU CSSE COVID-19 Data"),"."),r.a.createElement(X.a,{paragraph:!0},"Population density is derived from the"," ",r.a.createElement(ue.a,{href:"https://ghsl.jrc.ec.europa.eu/download.php?ds=pop"},"Global Human Settlement Layer"),". Schiavina, Marcello; Freire, Sergio; MacManus, Kytt (2019): GHS population grid multitemporal (1975, 1990, 2000, 2015) R2019A. European Commission, Joint Research Centre (JRC) DOI: 10.2905/42E8BE89-54FF-464E-BE7B-BF9E64DA5218 PID: http://data.europa.eu/89h/0c6b9751-a71f-4062-830b-43c9f432370f."),r.a.createElement(X.a,{paragraph:!0},"World & US GeoJson data was sourced from ",r.a.createElement(ue.a,{href:"https://github.com/nvkelso/natural-earth-vector"},"Natural Earth"),"."),r.a.createElement(X.a,{paragraph:!0},"China GeoJson data was sourced from ",r.a.createElement(ue.a,{href:"https://gadm.org/download_country_v3.html"},"GADM"),"."),r.a.createElement(X.a,{paragraph:!0},"Bathymetry texture was sourced from"," ",r.a.createElement(ue.a,{href:"https://www.naturalearthdata.com/downloads/50m-raster-data/50m-bathymetry"},"Natural Earth"),"."))),r.a.createElement(de.a,{in:S,timeout:"auto",unmountOnExit:!0},r.a.createElement(J.a,{className:"dependencies"},r.a.createElement(X.a,{paragraph:!0},"This application uses the following libraries:"),Object.keys(null!==D&&void 0!==D?D:{}).map((function(e){var t=D[e];return r.a.createElement(X.a,{key:e,paragraph:!0},r.a.createElement(ue.a,{href:t.repository},e)," licensed as ",r.a.createElement(ue.a,{onClick:function(){return R(t.licenseText)}},t.license),".")}))))))),r.a.createElement(me.a,{open:void 0!==T,onClick:function(){return R(void 0)},className:"license-backdrop"},r.a.createElement(Y.a,{className:"license-card"},r.a.createElement(J.a,{className:"license-content"},r.a.createElement(fe.a,{multiline:!0,value:T,InputProps:{readOnly:!0}})))))}a(218);var be=function(){var e=Object(n.useRef)(null),t=Object(n.useState)(),a=Object(d.a)(t,2),i=a[0],o=a[1],c=Object(n.useState)(),g=Object(d.a)(c,2),b=g[0],_=g[1],E=Object(n.useState)(),y=Object(d.a)(E,2),x=y[0],j=y[1],C=Object(n.useState)(),I=Object(d.a)(C,2),N=I[0],R=I[1],A=Object(n.useState)(),P=Object(d.a)(A,2),V=P[0],B=P[1],Y=Object(n.useState)(),H=Object(d.a)(Y,2),J=H[0],L=H[1],X=Object(n.useState)(),q=Object(d.a)(X,2),W=q[0],K=q[1],Q=Object(n.useState)(),$=Object(d.a)(Q,2),Z=$[0],ee=$[1],te=Object(n.useState)(),ae=Object(d.a)(te,2),ne=ae[0],re=ae[1],ie=Object(n.useState)(),oe=Object(d.a)(ie,2),ce=oe[0],se=oe[1],le=Object(n.useState)(!0),ue=Object(d.a)(le,2),de=ue[0],me=ue[1],fe=Object(n.useState)({dispatcher:v.f("timeChanged"),_time:0,_paused:!0,_intervalId:void 0,extinction:30,useRecoveryData:!0,keepDeaths:!0,get time(){return this._time},set time(e){this._time!==e&&(this._time=e,this.dispatcher.call("timeChanged",null,this._time,this.date))},get date(){var e=this.startDate;if(void 0!==e)return new Date(e.valueOf()+864e5*this.time)},set date(e){var t=this.startDate;void 0!==t&&void 0!==e&&(this.time=(e.valueOf()-t.valueOf())/864e5)},get paused(){return this._paused},set paused(e){if(e!==this.paused&&(this._paused=e,void 0!==this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),!this.paused)){var t=void 0;this._intervalId=setInterval((function(){var e,a=Date.now(),n=(a-(null!==(e=t)&&void 0!==e?e:a))/1e3;t=a,ve.time+=4*n}),1e3/60)}}}),ve=Object(d.a)(fe,1)[0];Object(n.useEffect)((function(){var t=e.current;if(t){var a=function(e){var t=new M.a({animateIn:!1}).globeImageUrl("./BATH_50M_2.png").bumpImageUrl("//unpkg.com/three-globe/example/img/earth-topology.png");t.globeMaterial().polygonOffset=!0,t.globeMaterial().polygonOffsetFactor=1,t.globeMaterial().polygonOffsetUnits=1,t.showAtmosphere(!0);var a=new m.hb,n=new m.R,r=new m.M;e.appendChild(a.domElement),n.add(new m.c(12303291)),n.add(new m.o(16777215,.6)),n.add(t),r.position.x=200,r.position.y=200;var i=new D.a(r,a.domElement);i.minDistance=101,i.rotateSpeed=.5,i.zoomSpeed=1.6;return new ResizeObserver((function(){var t=e.getBoundingClientRect(),n=t.width,i=t.height;a.setSize(n,i),r.aspect=n/i,r.updateProjectionMatrix()})).observe(e),function e(){i.update(),a.render(n,r),requestAnimationFrame(e)}(),{renderer:a,scene:n,camera:r,globe:t}}(t);_(a.globe),o(a.scene),j(a.renderer),R(a.camera)}}),[]),Object(n.useEffect)((function(){if(V&&N&&b&&x){z({camera:N,globe:b,renderer:x,onClick:function(e){var t,a;if(!e)return se(void 0);var n=[e.lng,e.lat],r=null===V||void 0===V||null===(t=V.features)||void 0===t||null===(a=t.find)||void 0===a?void 0:a.call(t,(function(e){return v.k(e.geometry,n)})),i=O(r),o=w(r);se(null!==o&&void 0!==o?o:i)}})}}),[V,x,N,b]),Object(n.useEffect)((function(){if(i&&(ve.selectedRegionLines&&(null===i||void 0===i||i.remove(ve.selectedRegionLines),ve.selectedRegionLines=void 0),V&&ce)){var e,t=new m.B({color:"white"}),a=Object(u.a)(V.features);try{for(a.s();!(e=a.n()).done;){var n=e.value;if(O(n)===ce||w(n)===ce){ve.selectedRegionLines=new m.C(new f.a(n.geometry,100.1),t),i.add(ve.selectedRegionLines);break}}}catch(r){a.e(r)}finally{a.f()}}}),[V,ce,i,ve]),Object(n.useEffect)((function(){T().then((function(e){return re(e)}))}),[]),Object(n.useEffect)((function(){Object(l.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=B,e.next=3,S();case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})))()}),[]),Object(n.useEffect)((function(){if(i&&V){var e,t=new m.B({color:"red"}),a=Object(u.a)(V.features);try{for(a.s();!(e=a.n()).done;){var n=e.value,r=new m.C(new f.a(n.geometry,100),t);i.add(r)}}catch(o){a.e(o)}finally{a.f()}}}),[i,V]),Object(n.useEffect)((function(){V&&k([{path:"https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_global.csv",func:L},{path:"https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_recovered_global.csv",func:K},{path:"https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_deaths_global.csv",func:ee},{path:"https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_US.csv",func:L},{path:"https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_deaths_US.csv",func:ee}],V,ve)}),[ve,V]),Object(n.useEffect)((function(){var t=e.current;t&&J&&Z&&ve&&function(e){var t=e.element,a=e.globals,n=e.statsConfirmed,r=e.statsDeaths,i=e.selectedRegion;v.p(t).selectAll("svg#chart").data([]).exit().remove();var o=v.p(t).selectAll("svg#chart").data([0]).enter().append("svg").attr("id","chart"),c=n.dates,s=n.data,l=r.data,u=[],d=[],m=function(e){return void 0===i||e.country===i||e.state===i};s.forEach((function(e){m(e)&&e.values.forEach((function(e,t){var a;u[t]=(null!==(a=u[t])&&void 0!==a?a:0)+e}))})),l.forEach((function(e){m(e)&&e.values.forEach((function(e,t){var a;d[t]=(null!==(a=d[t])&&void 0!==a?a:0)+e}))}));var f=U(u),h=U(d),p=o.node(),g=v.o().domain(v.i(c)),b={x:g},_=v.n().domain([0,v.m(u)]).nice(),E=v.n().domain([0,v.m(d)]).nice(),y=v.n().domain([1,1.25]).nice(),x=v.a(g).tickSizeOuter(0),O=v.b(_),w=v.c(E),j=o.append("g").attr("class","y-confirmed-axis").call(O),S=o.append("g").attr("class","y-deaths-axis").call(w),C=v.l().defined((function(e){return!isNaN(e.value)})).x((function(e){return b.x(e.date)})).y((function(e){return _(e.value)})),I=v.l().defined((function(e){return!isNaN(e.value)})).x((function(e){return b.x(e.date)})).y((function(e){return E(e.value)})),k=v.l().defined((function(e){return!isNaN(e.value)})).x((function(e){return b.x(e.date)})).y((function(e){return y(e.value)})),D=o.append("defs").append("clipPath").attr("id","clip").append("rect"),M=u.map((function(e,t){return{value:e,date:c[t]}})),z=d.map((function(e,t){return{value:e,date:c[t]}})),N=f.map((function(e,t){return{value:e,date:c[t]}})),T=h.map((function(e,t){return{value:e,date:c[t]}})),R=function(e,t){return o.append("path").datum(e).attr("class","path").attr("fill","none").attr("clip-path","url(#clip)").attr("stroke-width",1.5).attr("d",t)};R(N,k).attr("stroke","steelblue").attr("stroke-opacity","33%").attr("class","rate-path"),R(T,k).attr("stroke","red").attr("stroke-opacity","33%").attr("class","rate-path"),R(M,C).attr("stroke","steelblue").attr("class","confirmed-path"),R(z,I).attr("stroke","red").attr("class","deaths-path");var A=o.append("g").attr("clip-path","url(#clip)").attr("class","chart-overlay"),P=A.append("path").attr("class","current-time current-time-drag").style("stroke","yellow").style("stroke-width","16px");A.append("path").attr("class","current-time").style("stroke","red").style("stroke-width","1px");var V=A.selectAll(".current-time"),B=void 0,F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(void 0!==e?B=e:e=B,void 0!==e){var t=p.getBoundingClientRect(),a=t.height,n=b.x(e);V.datum([[n,G[1]],[n,a-G[1]]]).attr("d",v.l())}};a.dispatcher.on("timeChanged.chart",(function(e,t){return F(t)}));var Y=o.append("g").attr("clip-path","url(#clip)").append("g").attr("class","x-axis").call(x);function H(){var e=v.h,t="drag"===e.type&&[e.x,e.y]||v.d(e.target,e);return b.x.invert(t[0])}o.append("text").classed("title",!0).attr("x","50%").attr("y",64).text(null!==i&&void 0!==i?i:"Global"),o.append("text").classed("legend-left",!0).attr("x","0%").attr("y",128).text("Confirmed"),o.append("text").classed("legend-right",!0).attr("x","100%").attr("y",128).text("Deaths"),o.on("click",(function(){a.date=H()}));var J={paused:!1},L=v.g().on("start",(function(){J.paused=a.paused,a.paused=!0})).on("end",(function(){a.paused=J.paused})).on("drag",(function(){a.date=H()}));P.call(L);var X,q={},W=function(e){var t=p.getBoundingClientRect(),a=t.width,n=t.height,r=[[G[0],G[1]],[a-G[0],n-G[1]]],i=function(){var t,a,n=null!==(t=null===(a=v.h)||void 0===a?void 0:a.transform)&&void 0!==t?t:v.t(e.node());b.x=n.rescaleX(g),e.selectAll(".confirmed-path").attr("d",C),e.selectAll(".deaths-path").attr("d",I),e.selectAll(".rate-path").attr("d",k),x.scale(b.x),e.select(".x-axis").call(x),F()},o=v.r().scaleExtent([1,20]).extent(r).on("zoom",i);X=o,e.call(o),i()};new ResizeObserver((function(){if(p){var e=p.getBoundingClientRect(),t=e.width,a=e.height;g.range([0+G[0],t-G[0]]),[_,E,y].forEach((function(e){return e.range([a-G[1],0+G[1]])})),Y.attr("transform","translate(0,".concat(a-G[1],")")).call(x),j.attr("transform","translate(".concat(0+G[0],",0)")).call(O),S.attr("transform","translate(".concat(t-G[0],",0)")).call(w),D.attr("x",G[0]).attr("y",G[1]).attr("width",t-2*G[0]).attr("height",a-G[1]),void 0!==q.width&&o.call(X.transform,v.s),q={width:t,height:a},o.call(W)}})).observe(t)}({element:t,globals:ve,statsConfirmed:J,statsDeaths:Z,selectedRegion:ce})}),[J,Z,ve,ce]),Object(n.useEffect)((function(){if(ne&&i&&V&&J&&W&&Z){var e=F(ne,V,ve,J,W,Z);i.add(e),me(!1)}}),[i,ne,V,ve,J,W,Z]);var he=r.a.useMemo((function(){return Object(h.a)({palette:{type:"dark",primary:{main:"#648dae"}}})}),[]);return ve.paused=de,r.a.createElement(p.a,{theme:he},r.a.createElement("div",{className:"App",ref:e}),r.a.createElement(ge,{paused:de,setPaused:function(e){me(e)},globals:ve}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(be,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[204,1,2]]]);
//# sourceMappingURL=main.3b29b39f.chunk.js.map